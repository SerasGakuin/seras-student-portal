<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Seras学院 予約システム</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Noto+Sans+JP:wght@500;700;900&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="../assets/css/variables.css">
    <link rel="stylesheet" href="../assets/css/base.css">
    <link rel="stylesheet" href="../assets/css/components.css">
    <link rel="stylesheet" href="../assets/css/animations.css">
    <link rel="stylesheet" href="css/style.css">
    <!-- LIFF SDK -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>

<body>

    <div class="container">
        <header>
            <h1><span class="brand">Seras学院</span> 予約メニュー</h1>
            <div id="userInfo" class="user-info user-badge">読み込み中...</div>
        </header>

        <!-- メニュー画面 -->
        <div id="menuScreen" class="screen active">
            <div class="glass-card">
                <p style="margin-bottom: 20px; font-weight: 700;">ご希望の手続きを選択してください</p>

                <button class="btn-base btn-meeting" onclick="app.showMeetingForm()">
                    <span class="menu-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </span>
                    面談を予約する
                </button>

                <button class="btn-base btn-rest" onclick="app.showRestForm()">
                    <span class="menu-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
                            <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
                            <line x1="6" y1="1" x2="6" y2="4"></line>
                            <line x1="10" y1="1" x2="10" y2="4"></line>
                            <line x1="14" y1="1" x2="14" y2="4"></line>
                        </svg>
                    </span>
                    休む日を登録する
                </button>
            </div>
        </div>

        <!-- 面談予約フォーム -->
        <div id="meetingScreen" class="screen">
            <div class="glass-card">
                <h2>面談予約</h2>
                <form id="meetingForm">
                    <div class="form-group">
                        <label>面談タイプ</label>
                        <select id="meetingType" class="form-input" required>
                            <option value="面談">面談</option>
                            <option value="特訓">特訓</option>
                            <option value="強制通塾">強制通塾</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>日付</label>
                        <select id="meetingDate" class="form-input" required>
                            <!-- JSで動的に生成 -->
                            <option value="">日付を選択...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>来塾時間</label>
                        <select id="arrivalTime" class="form-input" required>
                            <option value="T14:00:00">午前~15:00</option>
                            <option value="T15:00:00">15:00~16:00</option>
                            <option value="T16:00:00">16:00~17:00</option>
                            <option value="T17:00:00">17:00~18:00</option>
                            <option value="T18:00:00">18:00~19:00</option>
                            <option value="T19:00:00">19:00~20:00</option>
                            <option value="T20:00:00">20:00~21:00</option>
                            <option value="T21:00:00">21:00~22:00</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>退塾時間</label>
                        <select id="leaveTime" class="form-input" required>
                            <option value="T15:00:00">午前~15:00</option>
                            <option value="T16:00:00">15:00~16:00</option>
                            <option value="T17:00:00">16:00~17:00</option>
                            <option value="T18:00:00">17:00~18:00</option>
                            <option value="T19:00:00">18:00~19:00</option>
                            <option value="T20:00:00">19:00~20:00</option>
                            <option value="T21:00:00">20:00~21:00</option>
                            <option value="T22:00:00">21:00~22:00</option>
                        </select>
                    </div>

                    <button type="submit" class="btn-base btn-primary">予約する</button>
                </form>
                <a href="#" class="back-link" onclick="app.showMenu()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        style="margin-right: 4px; vertical-align: middle;">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    メニューに戻る
                </a>
            </div>
        </div>

        <!-- 休み登録フォーム -->
        <div id="restScreen" class="screen">
            <div class="glass-card">
                <h2>休み登録</h2>
                <form id="restForm">
                    <div class="form-group">
                        <label>休む日</label>
                        <input type="date" id="restDate" class="form-input" required>
                    </div>

                    <button type="submit" class="btn-base btn-gradient-teal">登録する</button>
                </form>
                <a href="#" class="back-link" onclick="app.showMenu()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        style="margin-right: 4px; vertical-align: middle;">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    メニューに戻る
                </a>
            </div>
        </div>

    </div>

    <!-- ローディング -->
    <div id="loading" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- メインスクリプト -->
    <script type="module">
        import { App } from './js/app.js';
        import * as Meeting from './js/meeting.js';
        import * as Rest from './js/rest.js';

        // DOM読み込み完了時に初期化
        window.addEventListener('DOMContentLoaded', async () => {
            // モジュールの初期化
            Meeting.init();
            Rest.init();

            // アプリの初期化
            await App.init();

            // バリデーションメッセージの日本語化
            const requiredInputs = document.querySelectorAll('input[required], select[required]');
            requiredInputs.forEach(input => {
                input.addEventListener('invalid', () => {
                    if (input.validity.valueMissing) {
                        input.setCustomValidity('この項目は必須です。選択または入力してください。');
                    }
                });
                input.addEventListener('input', () => {
                    input.setCustomValidity('');
                });
            });
        });
    </script>
</body>

</html>